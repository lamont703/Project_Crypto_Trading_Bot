<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Market Watch - AI Trading Signals MVP</title>
    <link rel="stylesheet" href="components.css">
    <style>
        .market-overview {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--info-color) 100%);
            color: var(--text-inverse);
            padding: var(--spacing-lg);
            border-radius: var(--radius-md);
            text-align: center;
            margin-bottom: var(--spacing-xl);
        }
        
        .market-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: var(--spacing-md);
            margin-top: var(--spacing-lg);
        }
        
        .stat-item {
            text-align: center;
        }
        
        .stat-value {
            font-size: var(--font-size-xl);
            font-weight: 700;
            margin-bottom: var(--spacing-xs);
        }
        
        .stat-label {
            font-size: var(--font-size-sm);
            opacity: 0.9;
        }
        
        .filters-section {
            background-color: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            padding: var(--spacing-lg);
            margin-bottom: var(--spacing-xl);
        }
        
        .filters-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: var(--spacing-md);
        }
        
        .tickers-table {
            background-color: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            overflow: hidden;
            margin-bottom: var(--spacing-xl);
        }
        
        .table-header {
            background-color: var(--bg-secondary);
            padding: var(--spacing-md);
            border-bottom: 1px solid var(--border-color-light);
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 1fr 1fr 1fr;
            gap: var(--spacing-sm);
            font-weight: 600;
            font-size: var(--font-size-sm);
            color: var(--text-secondary);
        }
        
        .table-content {
            max-height: 500px;
            overflow-y: auto;
        }
        
        .table-row {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 1fr 1fr 1fr;
            gap: var(--spacing-sm);
            padding: var(--spacing-md);
            border-bottom: 1px solid var(--border-color-light);
            align-items: center;
            cursor: pointer;
            transition: background-color var(--transition-fast);
        }
        
        .table-row:hover {
            background-color: var(--bg-secondary);
        }
        
        .table-row:last-child {
            border-bottom: none;
        }
        
        .ticker-info {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
        }
        
        .ticker-symbol {
            font-weight: 600;
            color: var(--primary-color);
        }
        
        .ticker-name {
            font-size: var(--font-size-sm);
            color: var(--text-secondary);
        }
        
        .price {
            font-weight: 600;
            font-size: var(--font-size-lg);
        }
        
        .change {
            font-weight: 600;
        }
        
        .change.positive {
            color: var(--success-color);
        }
        
        .change.negative {
            color: var(--danger-color);
        }
        
        .volume {
            font-size: var(--font-size-sm);
            color: var(--text-secondary);
        }
        
        .market-cap {
            font-size: var(--font-size-sm);
            color: var(--text-secondary);
        }
        
        .chart-container {
            background-color: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            padding: var(--spacing-lg);
            margin-bottom: var(--spacing-xl);
        }
        
        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--spacing-lg);
            padding-bottom: var(--spacing-sm);
            border-bottom: 1px solid var(--border-color);
        }
        
        .chart-title {
            font-size: var(--font-size-lg);
            font-weight: 600;
            margin: 0;
        }
        
        .chart-controls {
            display: flex;
            gap: var(--spacing-sm);
        }
        
        .chart-canvas {
            width: 100%;
            height: 300px;
            background-color: var(--bg-secondary);
            border-radius: var(--radius);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-secondary);
        }
        
        .signal-overlay {
            position: absolute;
            top: var(--spacing-md);
            right: var(--spacing-md);
            background-color: var(--success-color);
            color: var(--text-inverse);
            padding: var(--spacing-sm);
            border-radius: var(--radius);
            font-size: var(--font-size-sm);
            font-weight: 600;
        }
        
        .api-status {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            padding: var(--spacing-sm);
            background-color: var(--bg-secondary);
            border-radius: var(--radius);
            margin-bottom: var(--spacing-lg);
        }
        
        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: var(--success-color);
        }
        
        .status-text {
            font-size: var(--font-size-sm);
            color: var(--text-secondary);
        }
        
        @media (min-width: 768px) {
            .filters-grid {
                grid-template-columns: 1fr 1fr 1fr;
            }
            
            .market-stats {
                grid-template-columns: repeat(4, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <div class="header-content">
                <h1 class="header-title">AI Trading Signals MVP</h1>
                <nav class="header-nav">
                    <a href="dashboard.html" class="nav-link">Dashboard</a>
                    <a href="strategy-builder.html" class="nav-link">Strategy Builder</a>
                    <a href="backtesting.html" class="nav-link">Backtesting</a>
                    <a href="trade-execution.html" class="nav-link">Trade Execution</a>
                    <a href="settings.html" class="nav-link">Settings</a>
                </nav>
            </div>
        </header>

        <main class="main">
            <div class="breadcrumb">
                <a href="../index.html">‚Üê Back to Hub</a> / Market Watch
            </div>

            <div class="api-status">
                <div class="status-dot"></div>
                <span class="status-text">Node.js API: Connected | Real-time Data: Active | Signal Engine: Running</span>
            </div>

            <div class="market-overview">
                <h2>Market Overview</h2>
                <p>Real-time market data powered by Node.js backend</p>
                <div class="market-stats">
                    <div class="stat-item">
                        <div class="stat-value">$2.1T</div>
                        <div class="stat-label">Total Market Cap</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">+2.4%</div>
                        <div class="stat-label">24h Change</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">$45.2B</div>
                        <div class="stat-label">24h Volume</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">3</div>
                        <div class="stat-label">Active Signals</div>
                    </div>
                </div>
            </div>

            <div class="filters-section">
                <h3>Filters & Search</h3>
                <div class="filters-grid">
                    <div class="form-group">
                        <label for="searchInput">Search Assets</label>
                        <input type="text" id="searchInput" placeholder="Search by symbol or name...">
                    </div>
                    <div class="form-group">
                        <label for="sortSelect">Sort By</label>
                        <select id="sortSelect">
                            <option value="marketCap">Market Cap</option>
                            <option value="price">Price</option>
                            <option value="change24h">24h Change</option>
                            <option value="volume24h">24h Volume</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="filterSelect">Filter</label>
                        <select id="filterSelect">
                            <option value="all">All Assets</option>
                            <option value="crypto">Cryptocurrencies</option>
                            <option value="stocks">Stocks</option>
                            <option value="signals">With Signals</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="tickers-table">
                <div class="table-header">
                    <div>Asset</div>
                    <div>Price</div>
                    <div>24h Change</div>
                    <div>Volume</div>
                    <div>Market Cap</div>
                    <div>Signal</div>
                </div>
                <div class="table-content" id="tickersList">
                    <!-- Tickers will be loaded here -->
                </div>
            </div>

            <div class="chart-container">
                <div class="chart-header">
                    <h3 class="chart-title">Price Chart</h3>
                    <div class="chart-controls">
                        <select id="timeframeSelect">
                            <option value="1h">1 Hour</option>
                            <option value="4h">4 Hours</option>
                            <option value="1d">1 Day</option>
                            <option value="1w">1 Week</option>
                        </select>
                        <button class="btn btn-secondary btn-small" onclick="refreshChart()">Refresh</button>
                    </div>
                </div>
                <div class="chart-canvas" id="chartCanvas">
                    <div>Select an asset to view chart</div>
                </div>
            </div>
        </main>

        <footer class="footer">
            <div class="footer-content">
                <p>&copy; 2024 AI Trading Signals MVP. Built with Node.js, React, and TypeScript.</p>
            </div>
        </footer>
    </div>

    <script>
        // Mock market data
        const mockMarketData = [
            {
                symbol: "BTC",
                name: "Bitcoin",
                price: 46500.00,
                change24h: 0.025,
                volume24h: 1234567.89,
                marketCap: 912345678901.23,
                hasSignal: true,
                signalType: "BUY",
                signalConfidence: 85
            },
            {
                symbol: "ETH",
                name: "Ethereum",
                price: 2400.00,
                change24h: -0.012,
                volume24h: 543210.98,
                marketCap: 289123456789.01,
                hasSignal: true,
                signalType: "SELL",
                signalConfidence: 72
            },
            {
                symbol: "SOL",
                name: "Solana",
                price: 95.00,
                change24h: 0.045,
                volume24h: 98765.43,
                marketCap: 41234567890.12,
                hasSignal: true,
                signalType: "HOLD",
                signalConfidence: 60
            },
            {
                symbol: "SPY",
                name: "S&P 500 ETF",
                price: 485.50,
                change24h: 0.008,
                volume24h: 456789.12,
                marketCap: 456789012345.67,
                hasSignal: false,
                signalType: null,
                signalConfidence: null
            }
        ];

        let currentChartAsset = null;

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            loadTickers();
            setupEventListeners();
        });

        // Setup event listeners
        function setupEventListeners() {
            // Search functionality
            document.getElementById('searchInput').addEventListener('input', filterTickers);
            
            // Sort functionality
            document.getElementById('sortSelect').addEventListener('change', sortTickers);
            
            // Filter functionality
            document.getElementById('filterSelect').addEventListener('change', filterTickers);
            
            // Timeframe selection
            document.getElementById('timeframeSelect').addEventListener('change', function() {
                if (currentChartAsset) {
                    updateChart(currentChartAsset);
                }
            });
        }

        // Load tickers
        function loadTickers() {
            const tickersList = document.getElementById('tickersList');
            tickersList.innerHTML = '';

            mockMarketData.forEach(ticker => {
                const tickerRow = document.createElement('div');
                tickerRow.className = 'table-row';
                tickerRow.onclick = () => selectAsset(ticker);
                
                const changeClass = ticker.change24h >= 0 ? 'positive' : 'negative';
                const changeSign = ticker.change24h >= 0 ? '+' : '';
                
                tickerRow.innerHTML = `
                    <div class="ticker-info">
                        <div>
                            <div class="ticker-symbol">${ticker.symbol}</div>
                            <div class="ticker-name">${ticker.name}</div>
                        </div>
                    </div>
                    <div class="price">$${ticker.price.toLocaleString()}</div>
                    <div class="change ${changeClass}">
                        ${changeSign}${(ticker.change24h * 100).toFixed(2)}%
                    </div>
                    <div class="volume">$${(ticker.volume24h / 1000000).toFixed(1)}M</div>
                    <div class="market-cap">$${(ticker.marketCap / 1000000000).toFixed(1)}B</div>
                    <div>
                        ${ticker.hasSignal ? 
                            `<span class="badge badge-${ticker.signalType.toLowerCase()}">${ticker.signalType} ${ticker.signalConfidence}%</span>` : 
                            '<span class="badge badge-secondary">No Signal</span>'
                        }
                    </div>
                `;
                tickersList.appendChild(tickerRow);
            });
        }

        // Filter tickers
        function filterTickers() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const filterValue = document.getElementById('filterSelect').value;
            const rows = document.querySelectorAll('.table-row');
            
            rows.forEach(row => {
                const symbol = row.querySelector('.ticker-symbol').textContent.toLowerCase();
                const name = row.querySelector('.ticker-name').textContent.toLowerCase();
                const hasSignal = row.querySelector('.badge').textContent.includes('No Signal') === false;
                
                let showRow = true;
                
                // Search filter
                if (searchTerm && !symbol.includes(searchTerm) && !name.includes(searchTerm)) {
                    showRow = false;
                }
                
                // Category filter
                if (filterValue === 'crypto' && symbol === 'SPY') {
                    showRow = false;
                } else if (filterValue === 'stocks' && symbol !== 'SPY') {
                    showRow = false;
                } else if (filterValue === 'signals' && !hasSignal) {
                    showRow = false;
                }
                
                row.style.display = showRow ? 'grid' : 'none';
            });
        }

        // Sort tickers
        function sortTickers() {
            const sortBy = document.getElementById('sortSelect').value;
            const tickersList = document.getElementById('tickersList');
            const rows = Array.from(tickersList.querySelectorAll('.table-row'));
            
            rows.sort((a, b) => {
                let aValue, bValue;
                
                switch (sortBy) {
                    case 'price':
                        aValue = parseFloat(a.querySelector('.price').textContent.replace('$', '').replace(',', ''));
                        bValue = parseFloat(b.querySelector('.price').textContent.replace('$', '').replace(',', ''));
                        break;
                    case 'change24h':
                        aValue = parseFloat(a.querySelector('.change').textContent.replace('%', '').replace('+', ''));
                        bValue = parseFloat(b.querySelector('.change').textContent.replace('%', '').replace('+', ''));
                        break;
                    case 'volume24h':
                        aValue = parseFloat(a.querySelector('.volume').textContent.replace('$', '').replace('M', ''));
                        bValue = parseFloat(b.querySelector('.volume').textContent.replace('$', '').replace('M', ''));
                        break;
                    case 'marketCap':
                        aValue = parseFloat(a.querySelector('.market-cap').textContent.replace('$', '').replace('B', ''));
                        bValue = parseFloat(b.querySelector('.market-cap').textContent.replace('$', '').replace('B', ''));
                        break;
                    default:
                        return 0;
                }
                
                return bValue - aValue;
            });
            
            // Re-append sorted rows
            rows.forEach(row => tickersList.appendChild(row));
        }

        // Select asset for chart
        function selectAsset(ticker) {
            currentChartAsset = ticker;
            updateChart(ticker);
            
            // Highlight selected row
            document.querySelectorAll('.table-row').forEach(row => {
                row.style.backgroundColor = '';
            });
            event.currentTarget.style.backgroundColor = 'var(--bg-secondary)';
        }

        // Update chart
        function updateChart(ticker) {
            const chartCanvas = document.getElementById('chartCanvas');
            const timeframe = document.getElementById('timeframeSelect').value;
            
            // Simulate chart data loading
            chartCanvas.innerHTML = `
                <div style="text-align: center;">
                    <h4>${ticker.symbol} - ${ticker.name}</h4>
                    <p>Price: $${ticker.price.toLocaleString()}</p>
                    <p>24h Change: ${ticker.change24h >= 0 ? '+' : ''}${(ticker.change24h * 100).toFixed(2)}%</p>
                    <p>Timeframe: ${timeframe}</p>
                    <p style="margin-top: 20px; color: var(--text-secondary);">
                        Chart would be rendered here using Chart.js<br>
                        Data fetched from Node.js API
                    </p>
                    ${ticker.hasSignal ? `
                        <div style="margin-top: 20px;">
                            <span class="badge badge-${ticker.signalType.toLowerCase()}">
                                ${ticker.signalType} Signal - ${ticker.signalConfidence}% Confidence
                            </span>
                        </div>
                    ` : ''}
                </div>
            `;
            
            console.log(`Chart updated for ${ticker.symbol} with ${timeframe} timeframe`);
        }

        // Refresh chart
        function refreshChart() {
            if (currentChartAsset) {
                updateChart(currentChartAsset);
                alert('Chart refreshed with latest data from Node.js API');
            } else {
                alert('Please select an asset first');
            }
        }

        // Simulate real-time updates
        setInterval(() => {
            // Update market stats
            const stats = document.querySelectorAll('.stat-value');
            if (stats.length > 0) {
                // Simulate small changes in market data
                const currentValue = parseFloat(stats[0].textContent.replace('$', '').replace('T', ''));
                const newValue = currentValue + (Math.random() - 0.5) * 0.1;
                stats[0].textContent = '$' + newValue.toFixed(1) + 'T';
            }
        }, 10000);
    </script>
</body>
</html>
